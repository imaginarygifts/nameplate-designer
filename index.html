<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Imaginary Gifts Designer</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins&family=Cinzel+Decorative:wght@700&display=swap" rel="stylesheet">

<style>
body{margin:0;background:#eee;font-family:Poppins}
#brand{
  background:#000;
  text-align:center;
  padding:28px;
  font-size:36px;
  font-family:"Cinzel Decorative",serif;
  background-image:linear-gradient(135deg,#6e5200,#f9e784,#fff8dc,#d4af37,#6e5200);
  -webkit-background-clip:text;
  color:transparent;
}
#canvas{
  display:block;margin:12px auto;
  background:#fff;border:2px solid #000;
  border-radius:18px;touch-action:none;
}
#controls{
  background:#000;padding:16px;
  display:grid;grid-template-columns:1fr 1fr;gap:16px;
}
button,select{
  padding:26px;font-size:20px;
  background:#000;color:#f7f4e9;
  border:2px solid #f7f4e9;border-radius:14px;
}
</style>
</head>

<body>

<div id="brand">IMAGINARY GIFTS</div>
<canvas id="canvas"></canvas>

<div id="controls">
  <select onchange="addShape(this.value)">
    <option value="">Shape</option>
    <option value="rect">Rectangle</option>
    <option value="rounded">Rounded</option>
    <option value="circle">Circle</option>
  </select>
  <button onclick="addText()">Add Text</button>
</div>

<script>
const canvas=document.getElementById("canvas");
const ctx=canvas.getContext("2d");

let objects=[],selected=null;
let mode=null,sx=0,sy=0,startAngle=0;
let resizeStart={};

function resizeCanvas(){
  const s=Math.min(innerWidth-20,innerHeight*0.65);
  canvas.width=s;canvas.height=s;
  draw();
}
addEventListener("resize",resizeCanvas);

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  objects.forEach(o=>{
    ctx.save();

    if(o.type==="text"){
      ctx.font=`${o.size}px ${o.font}`;
      const m=ctx.measureText(o.text);
      o.w=m.width;
      o.h=o.size;
    }

    ctx.translate(o.x+o.w/2,o.y+o.h/2);
    ctx.rotate(o.rotation);
    ctx.translate(-o.w/2,-o.h/2);

    ctx.fillStyle=o.color;
    if(o.type==="shape"){
      if(o.shape==="rect") ctx.fillRect(0,0,o.w,o.h);
      if(o.shape==="rounded"){
        ctx.beginPath();
        ctx.roundRect(0,0,o.w,o.h,20);
        ctx.fill();
      }
      if(o.shape==="circle"){
        ctx.beginPath();
        ctx.arc(o.w/2,o.h/2,o.w/2,0,Math.PI*2);
        ctx.fill();
      }
    }
    if(o.type==="text"){
      ctx.fillText(o.text,0,o.h);
    }

    if(o===selected) drawHandles(o);
    ctx.restore();
  });
}

function drawHandles(o){
  ctx.strokeStyle="#1e90ff";
  ctx.strokeRect(0,0,o.w,o.h);
  icon(-18,-18,"×");
  icon(o.w+18,-18,"↻");
  icon(o.w+18,o.h+18,"↔");
}

function icon(x,y,t){
  ctx.beginPath();
  ctx.arc(x,y,14,0,Math.PI*2);
  ctx.fillStyle="#fff";ctx.fill();
  ctx.stroke();
  ctx.fillStyle="#000";
  ctx.fillText(t,x-6,y+6);
}

function addShape(type){
  if(!type)return;
  selected={
    type:"shape",shape:type,
    w:canvas.width*0.5,h:canvas.width*0.3,
    x:canvas.width*0.25,y:canvas.height*0.35,
    rotation:0,color:"#000"
  };
  objects.push(selected);draw();
}

function addText(){
  selected={
    type:"text",text:"YOUR NAME",
    font:"Cinzel Decorative",
    size:canvas.width*0.08,
    w:0,h:0,
    x:canvas.width*0.3,y:canvas.height*0.3,
    rotation:0,color:"#000"
  };
  objects.push(selected);draw();
}

function getLocal(o,p){
  const cx=o.x+o.w/2,cy=o.y+o.h/2;
  let dx=p.x-cx,dy=p.y-cy;
  const c=Math.cos(-o.rotation),s=Math.sin(-o.rotation);
  return{
    x:dx*c-dy*s+o.w/2,
    y:dx*s+dy*c+o.h/2
  };
}

function pos(e){
  const r=canvas.getBoundingClientRect();
  const t=e.touches?e.touches[0]:e;
  return{x:(t.clientX-r.left)*(canvas.width/r.width),
         y:(t.clientY-r.top)*(canvas.height/r.height)};
}

/* INTERACTION */
canvas.onmousedown=canvas.ontouchstart=e=>{
  e.preventDefault();
  const p=pos(e);
  selected=null;mode=null;

  for(let i=objects.length-1;i>=0;i--){
    const o=objects[i];
    const l=getLocal(o,p);

    if(Math.hypot(l.x+18,l.y+18)<18){objects.splice(i,1);draw();return;}

    if(Math.abs(l.x-o.w)<20&&Math.abs(l.y-o.h)<20){
      selected=o;mode="resize";
      resizeStart={w:o.w,h:o.h,cx:o.x+o.w/2,cy:o.y+o.h/2};
      sx=p.x;sy=p.y;break;
    }

    if(Math.hypot(l.x-(o.w+18),l.y+18)<18){
      selected=o;mode="rotate";
      startAngle=Math.atan2(p.y-(o.y+o.h/2),p.x-(o.x+o.w/2))-o.rotation;
      break;
    }

    if(l.x>0&&l.x<o.w&&l.y>0&&l.y<o.h){
      selected=o;mode="move";
      sx=p.x;sy=p.y;break;
    }
  }
  draw();
};

canvas.onmousemove=canvas.ontouchmove=e=>{
  if(!selected||!mode)return;
  e.preventDefault();
  const p=pos(e);

  if(mode==="move"){
    selected.x+=p.x-sx;selected.y+=p.y-sy;
  }

  if(mode==="resize"){
    const dw=p.x-sx,dh=p.y-sy;
    selected.w=Math.max(40,resizeStart.w+dw);
    selected.h=Math.max(40,resizeStart.h+dh);
    selected.x=resizeStart.cx-selected.w/2;
    selected.y=resizeStart.cy-selected.h/2;
    if(selected.type==="text") selected.size+=dh*0.4;
  }

  if(mode==="rotate"){
    selected.rotation=Math.atan2(
      p.y-(selected.y+selected.h/2),
      p.x-(selected.x+selected.w/2)
    )-startAngle;
  }

  sx=p.x;sy=p.y;
  draw();
};

canvas.onmouseup=canvas.ontouchend=()=>mode=null;

resizeCanvas();
</script>
</body>
</html>
