<!DOCTYPE html>  <html>      <head>      
<meta charset="UTF-8">      
<title>Imaginary Gifts â€“ Designer</title>  <link href="https://fonts.googleapis.com/css2?family=Poppins&family=Great+Vibes&family=Dancing+Script&family=Playfair+Display&family=Montserrat&family=Cinzel+Decorative:wght@700&display=swap" rel="stylesheet">  <style>      
body{margin:0;background:#000;font-family:Poppins}      /* LOGO */
#brand{
background:#000;
text-align:center;
padding:30px;
font-size:60px;
font-family:"Cinzel Decorative",serif;
background-image:linear-gradient(135deg,#7a5c00,#fff3b0,#7a5c00);
-webkit-background-clip:text;
-webkit-text-fill-color:transparent;
}

/* CANVAS */
#canvas{
background:#fff;
border:2px solid #000;
border-radius:18px;
display:block;
margin:10px auto;
touch-action:none;
}

/* BUTTONS */
.big-btn{
width:100%;
margin:10px auto;
padding:36px;
font-size:26px;
background:#000;
color:#f7f4e9;
border:2px solid #f7f4e9;
border-radius:14px;
display:none;
}
.small-btn{
display:block;
margin:10px auto;
padding:12px 24px;
font-size:14px;
background:#000;
color:#fff;
border:1px solid #fff;
border-radius:10px;
}

/* MINI TOOLS (RIGHT SIDE) */
.right-tools{
display:flex;
gap:10px;
}
.mini-btn{
padding:14px 16px;
font-size:50px;
background:#000;
color:#fff;
border:2px solid #fff;
border-radius:12px;
}

/* PALETTE */
.palette{
display:none;
overflow-x:auto;
white-space:nowrap;
padding:10px;
text-align:center;
}
.thumb{
width:50px;
height:50px;
display:inline-block;
border-radius:8px;
margin-right:10px;
border:2px solid #fff;
}

/* CONTROLS */
#controls{
background:#000;
padding:18px;
display:grid;
grid-template-columns:1fr auto;
gap:18px;
align-items:center;
}

.control-grid{
display:grid;
grid-template-columns:1fr 1fr;
gap:18px;
margin-top:18px;
}

button,select{
padding:30px;
font-size:22px;
background:#000;
color:#f7f4e9;
border:2px solid #f7f4e9;
border-radius:14px;
}
</style>  </head>  <body>  <div id="brand">Imaginary Gifts</div>  <canvas id="canvas"></canvas>

<!-- CANVAS COLOUR -->  <div id="canvasPalette" class="palette"></div>      <button class="small-btn" onclick="toggleCanvasPalette()">Canvas Colour</button>  <!-- ELEMENT COLOUR -->  <div id="colors" class="palette"></div>
<button id="colorBtn" class="big-btn" onclick="toggleColors()">SELECT COLOUR</button>  <!-- TOP CONTROLS ROW -->  <div id="controls">    <!-- LEFT: SHAPE SELECT -->    <select onchange="addShape(this.value)">
<option value="">Select Shape</option>
<option value="rect">Rectangle</option>
<option value="rounded">Rounded</option>
<option value="circle">Circle</option>
<option value="oval">Oval</option>
<option value="pill">Pill</option>
</select>    <!-- RIGHT: UNDO | LOCK | REDO -->    <div class="right-tools">
<button class="mini-btn" onclick="undo()">â†¶</button>
<button class="mini-btn" onclick="toggleLock()">ðŸ”’</button>
<button class="mini-btn" onclick="redo()">â†·</button>

  </div>  </div>  <!-- SECOND ROW CONTROLS -->  <div class="control-grid">      
  <button onclick="addText()">Add Text</button>    <select onchange="changeFont(this.value)">      
    <option value="">Select Font</option>      
    <option>Cinzel Decorative</option>      
    <option>Great Vibes</option>      
    <option>Dancing Script</option>      
    <option>Playfair Display</option>      
    <option>Montserrat</option>      
  </select>      
</div>

<div class="control-grid">
  <button onclick="addVector('logo','om')">Add Logo</button>
  <button onclick="addVector('border','simple')">Add Border</button>
</div>

  <button class="big-btn" style="display:block" onclick="saveImage()">SAVE DESIGN</button>    <!-- ================= SCRIPT (UNCHANGED LOGIC) ================= -->  <script>      /* ---------- CORE ---------- */
const canvas=document.getElementById("canvas");
const ctx=canvas.getContext("2d");

let canvasBg="#fff";
let objects=[],selected=null;
let mode=null,sx=0,sy=0,startAngle=0,lastTapTime=0;

/* ---------- HISTORY ---------- */
let history=[],redoStack=[];
function saveState(){
history.push(JSON.stringify({objects,canvasBg}));
if(history.length>50) history.shift();
redoStack=[];
}
function undo(){
if(!history.length) return;
redoStack.push(JSON.stringify({objects,canvasBg}));
const s=JSON.parse(history.pop());
objects=s.objects;canvasBg=s.canvasBg;selected=null;draw();
}
function redo(){
if(!redoStack.length) return;
history.push(JSON.stringify({objects,canvasBg}));
const s=JSON.parse(redoStack.pop());
objects=s.objects;canvasBg=s.canvasBg;selected=null;draw();
}

/* ---------- CONSTANTS ---------- */
const ELEMENT_COLORS=["#000","#fff","#5a3a22","#f7f4e9","#e74c3c","#3498db","#2ecc71","gold","silver","rosegold"];
const CANVAS_BACKGROUNDS=["#ffffff","#000000","#cccccc","#5a3a22"];

const VECTOR_LOGOS = {
  om: "M100 20 C60 20 40 60 60 90 C40 120 60 170 100 170 C140 170 160 120 140 90 C160 60 140 20 100 20 Z",
  swastik: "M20 20 H120 V60 H60 V120 H20 Z M80 80 H180 V20 H140 V80 Z M120 120 H180 V180 H120 Z M20 140 H80 V180 H20 Z"
};

const VECTOR_BORDERS = {
  simple: "M10 10 H190 V190 H10 Z",
  double: "M10 10 H190 V190 H10 Z M30 30 H170 V170 H30 Z"
};

/* ---------- CANVAS SIZE ---------- */
function resizeCanvas(){
canvas.width=Math.min(innerWidth-20,900);
canvas.height=700;
draw();
}
addEventListener("resize",resizeCanvas);

/* ---------- METALLIC ---------- */
function metallic(type,w){
const g=ctx.createLinearGradient(0,0,w,0);
if(type==="gold"){g.addColorStop(0,"#7a5c00");g.addColorStop(.5,"#fff3b0");g.addColorStop(1,"#7a5c00");}
if(type==="silver"){g.addColorStop(0,"#777");g.addColorStop(.5,"#fff");g.addColorStop(1,"#777");}
if(type==="rosegold"){g.addColorStop(0,"#8b5a5a");g.addColorStop(.5,"#f3c1c1");g.addColorStop(1,"#8b5a5a");}
return g;
}

/* ---------- DRAW ---------- */
function draw(){
ctx.clearRect(0,0,canvas.width,canvas.height);
ctx.fillStyle=canvasBg;
ctx.fillRect(0,0,canvas.width,canvas.height);

objects.forEach(o=>{
ctx.save();
ctx.translate(o.x+o.w/2,o.y+o.h/2);
ctx.rotate(o.rotation);
ctx.translate(-o.w/2,-o.h/2);

if(o.type==="shape"){      
  ctx.fillStyle=["gold","silver","rosegold"].includes(o.color)?metallic(o.color,o.w):o.color;      
  drawShape(o);      
}      
if(o.type==="text"){      
  ctx.font=`${o.size}px ${o.font}`;      
  ctx.textBaseline="top";      
  o.w=ctx.measureText(o.text).width;      
  o.h=o.size;      
  ctx.fillStyle=["gold","silver","rosegold"].includes(o.color)?metallic(o.color,o.w):o.color;      
  ctx.fillText(o.text,0,0);      
}      
if(o===selected) drawHandles(o);      
ctx.restore();

});
if(o.type === "vector"){
  ctx.save();

  const p = new Path2D(o.path);

  ctx.translate(o.x + o.w/2, o.y + o.h/2);
  ctx.rotate(o.rotation);
  ctx.scale(o.w/200, o.h/200);
  ctx.translate(-100, -100);

  ctx.fillStyle = ["gold","silver","rosegold"].includes(o.color)
    ? metallic(o.color,200)
    : o.color;

  ctx.fill(p);
  ctx.restore();
}
}

function drawShape(o){
ctx.beginPath();
if(o.shape==="rect") ctx.rect(0,0,o.w,o.h);
if(o.shape==="rounded") roundRect(0,0,o.w,o.h,20);
if(o.shape==="circle") ctx.arc(o.w/2,o.h/2,o.w/2,0,Math.PI2);
if(o.shape==="oval") ctx.ellipse(o.w/2,o.h/2,o.w/2,o.h/2,0,0,Math.PI2);
if(o.shape==="pill") roundRect(0,0,o.w,o.h,o.h/2);
ctx.fill();
}
function roundRect(x,y,w,h,r){
ctx.moveTo(x+r,y);
ctx.arcTo(x+w,y,x+w,y+h,r);
ctx.arcTo(x+w,y+h,x,y+h,r);
ctx.arcTo(x,y+h,x,y,r);
ctx.arcTo(x,y,x+w,y,r);
}

/* ---------- HANDLES ---------- /
function drawIcon(x,y,t){
ctx.beginPath();
ctx.arc(x,y,14,0,Math.PI2);
ctx.fillStyle="#fff";ctx.fill();ctx.stroke();
ctx.fillStyle="#000";ctx.font="16px Poppins";
ctx.fillText(t,x-6,y+6);
}
function drawHandles(o){
ctx.strokeStyle=o.locked?"#999":"#1e90ff";
ctx.strokeRect(0,0,o.w,o.h);
if(o.locked){drawIcon(o.w/2,-22,"ðŸ”’");return;}
drawIcon(-18,-18,"Ã—");
drawIcon(o.w+18,-18,"â†»");
drawIcon(o.w+18,o.h+18,"â†”");
}

/* ---------- INTERACTION ---------- /
function getPos(e){
const r=canvas.getBoundingClientRect();
const t=e.touches?e.touches[0]:e;
return{x:(t.clientX-r.left)(canvas.width/r.width),y:(t.clientY-r.top)*(canvas.height/r.height)};
}

canvas.onmousedown=canvas.ontouchstart=e=>{
saveState();
e.preventDefault();
const p=getPos(e);
selected=null;mode=null;

for(let i=objects.length-1;i>=0;i--){
const o=objects[i];
const cx=o.x+o.w/2,cy=o.y+o.h/2;
const dx=p.x-cx,dy=p.y-cy;
const cos=Math.cos(-o.rotation),sin=Math.sin(-o.rotation);
const rx=cosdx-sindy+o.w/2;
const ry=sindx+cosdy+o.h/2;

if(rx>0&&rx<o.w&&ry>0&&ry<o.h){      
  if(o.type==="text"&&!o.locked){      
    const now=Date.now();      
    if(now-lastTapTime<350){      
      const nt=prompt("Edit Text",o.text);      
      if(nt!==null){o.text=nt;draw();}      
      return;      
    }      
    lastTapTime=now;      
  }      
}      
if(!o.locked&&Math.hypot(rx+18,ry+18)<14){objects.splice(i,1);draw();return;}      
if(!o.locked&&Math.hypot(rx-(o.w+18),ry+18)<14){selected=o;mode="rotate";startAngle=Math.atan2(p.y-cy,p.x-cx)-o.rotation;break;}      
if(!o.locked&&Math.hypot(rx-(o.w+18),ry-(o.h+18))<14){selected=o;mode="resize";sx=p.x;sy=p.y;break;}      
if(rx>0&&rx<o.w&&ry>0&&ry<o.h){selected=o;if(!o.locked){mode="move";sx=p.x;sy=p.y;}break;}

}
colorBtn.style.display=selected?"block":"none";
draw();
};

canvas.onmousemove=canvas.ontouchmove=e=>{
if(!selected||!mode||selected.locked)return;
e.preventDefault();
const p=getPos(e);
if(mode==="move"){selected.x+=p.x-sx;selected.y+=p.y-sy;}
if(mode==="resize"){
selected.w+=p.x-sx;
selected.h+=p.y-sy;
if(selected.type==="text") selected.size+=(p.y-sy)*0.5;
}
if(mode==="rotate"){
const cx=selected.x+selected.w/2,cy=selected.y+selected.h/2;
selected.rotation=Math.atan2(p.y-cy,p.x-cx)-startAngle;
}
sx=p.x;sy=p.y;draw();
};

canvas.onmouseup=canvas.ontouchend=()=>mode=null;

function addVector(kind, key){
  saveState();

  const path = (kind === "logo" ? VECTOR_LOGOS[key] : VECTOR_BORDERS[key]);
  if(!path) return;

  const size = canvas.width * (kind === "border" ? 0.8 : 0.25);

  selected = {
    type: "vector",
    kind,
    path,
    x: (canvas.width - size) / 2,
    y: (canvas.height - size) / 2,
    w: size,
    h: size,
    rotation: 0,
    color: "#000",
    locked: false
  };

  objects.push(selected);
  colorBtn.style.display = "block";
  draw();
}

/* ---------- CONTROLS ---------- /
function addShape(s){
saveState();
if(!s)return;
objects=objects.filter(o=>o.type!=="shape");
const w=canvas.width0.6;
selected={type:"shape",shape:s,x:(canvas.width-w)/2,y:(canvas.height-(w0.6))/2,w:w,h:w0.6,rotation:0,color:"#000",locked:false};
objects.push(selected);colorBtn.style.display="block";draw();
}
function addText(){
saveState();
const t=prompt("Text","Your Name");
if(!t)return;
selected={type:"text",text:t,font:"Cinzel Decorative",size:canvas.width0.08,x:canvas.width0.2,y:canvas.height*0.45,rotation:0,color:"gold",locked:false};
objects.push(selected);colorBtn.style.display="block";draw();
}
function changeFont(f){saveState();if(selected&&selected.type==="text"){selected.font=f;draw();}}
function toggleLock(){saveState();if(selected){selected.locked=!selected.locked;draw();}}

function toggleColors(){
const c=document.getElementById("colors");
c.innerHTML="";
ELEMENT_COLORS.forEach(col=>{
const d=document.createElement("div");
d.className="thumb";
if(col==="gold")d.style.background="linear-gradient(135deg,#7a5c00,#fff3b0,#7a5c00)";
else if(col==="silver")d.style.background="linear-gradient(135deg,#777,#fff,#777)";
else if(col==="rosegold")d.style.background="linear-gradient(135deg,#8b5a5a,#f3c1c1,#8b5a5a)";
else d.style.background=col;
d.onclick=()=>{saveState();selected.color=col;c.style.display="none";draw();}
c.appendChild(d);
});
c.style.display=c.style.display==="block"?"none":"block";
}

function toggleCanvasPalette(){
const p=document.getElementById("canvasPalette");
p.innerHTML="";
CANVAS_BACKGROUNDS.forEach(c=>{
const d=document.createElement("div");
d.className="thumb";
d.style.background=c;
d.onclick=()=>{saveState();canvasBg=c;p.style.display="none";draw();}
p.appendChild(d);
});
p.style.display=p.style.display==="block"?"none":"block";
}

function saveImage(){
const a=document.createElement("a");
a.download="design.jpg";
a.href=canvas.toDataURL("image/jpeg",1);
a.click();
}

resizeCanvas();
draw();
</script>  </body>

</html>