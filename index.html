<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Nameplate Designer</title>

<!-- Fabric.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.0/fabric.min.js"></script>

<!-- Google Font -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">

<style>
body{
  margin:0;
  font-family:Poppins, sans-serif;
  background:#f2f2f2;
}

/* Canvas */
#canvasWrap{
  padding:15px;
  display:flex;
  justify-content:center;
}

canvas{
  background:#fff;
  border-radius:10px;
  box-shadow:0 0 10px rgba(0,0,0,.2);
}

/* Top bar */
#top{
  display:flex;
  gap:10px;
  padding:10px;
  background:#fff;
  justify-content:center;
}

/* Bottom toolbar */
#toolbar{
  position:fixed;
  bottom:0;
  left:0;
  right:0;
  background:#111;
  display:flex;
}

#toolbar button{
  flex:1;
  padding:14px;
  color:#fff;
  background:none;
  border:none;
  font-size:14px;
}

/* Popup */
.popup{
  display:none;
  position:fixed;
  bottom:70px;
  left:10px;
  right:10px;
  background:#fff;
  padding:10px;
  border-radius:10px;
}

.popup button, .popup input{
  width:100%;
  padding:10px;
  margin:5px 0;
}
</style>
</head>

<body>

<div id="top">
  <button onclick="exportJPG()">Save as JPG</button>
  <button onclick="deleteSelected()">Delete Selected</button>
</div>

<div id="canvasWrap">
  <canvas id="c" width="900" height="400"></canvas>
</div>

<!-- POPUPS -->
<div id="shapePopup" class="popup">
  <button onclick="addRect()">Rectangle</button>
  <button onclick="addCircle()">Circle</button>
</div>

<div id="textPopup" class="popup">
  <input id="textInput" placeholder="Enter name">
  <button onclick="addText()">Add Text</button>
</div>

<div id="logoPopup" class="popup">
  <button onclick="addImage('https://upload.wikimedia.org/wikipedia/commons/1/17/Om_symbol.svg')">Om</button>
  <button onclick="addImage('https://upload.wikimedia.org/wikipedia/commons/4/42/Christian_cross.svg')">Cross</button>
</div>

<div id="bgPopup" class="popup">
  <button onclick="setBackground('https://images.unsplash.com/photo-1523413651479-597eb2da0ad6')">Wood</button>
  <button onclick="setBackground('https://images.unsplash.com/photo-1501594907352-04cda38ebc29')">Dark</button>
  <button onclick="removeBackground()">Remove Background</button>
</div>

<div id="colorPopup" class="popup">
  <input type="color" onchange="changeColor(this.value)">
</div>

<!-- BOTTOM TOOLBAR -->
<div id="toolbar">
  <button onclick="toggle('shapePopup')">Shape</button>
  <button onclick="toggle('textPopup')">Text</button>
  <button onclick="toggle('logoPopup')">Logo</button>
  <button onclick="toggle('bgPopup')">Background</button>
  <button onclick="toggle('colorPopup')">Color</button>
</div>

<script>
const canvas = new fabric.Canvas('c', {
  preserveObjectStacking:true
});

/* Popup toggle */
function toggle(id){
  document.querySelectorAll('.popup').forEach(p=>p.style.display='none');
  document.getElementById(id).style.display='block';
}

/* Shapes */
function addRect(){
  const rect = new fabric.Rect({
    left:200,
    top:120,
    width:300,
    height:120,
    rx:15,
    fill:'#000'
  });
  canvas.add(rect);
  canvas.setActiveObject(rect);
}

function addCircle(){
  const circle = new fabric.Circle({
    left:250,
    top:100,
    radius:80,
    fill:'#000'
  });
  canvas.add(circle);
  canvas.setActiveObject(circle);
}

/* Text */
function addText(){
  const val = document.getElementById('textInput').value || 'Your Name';
  const text = new fabric.Textbox(val,{
    left:250,
    top:150,
    fontSize:40,
    fill:'#fff',
    fontFamily:'Poppins'
  });
  canvas.add(text);
  canvas.setActiveObject(text);
}

/* Images (logos / borders) */
function addImage(url){
  fabric.Image.fromURL(url, img=>{
    img.set({
      left:300,
      top:150,
      scaleX:0.2,
      scaleY:0.2,
      crossOrigin:'anonymous'
    });
    canvas.add(img);
    canvas.setActiveObject(img);
  });
}

/* Color change */
function changeColor(color){
  const obj = canvas.getActiveObject();
  if(!obj) return;
  if(obj.type === 'textbox'){
    obj.set('fill',color);
  }else{
    obj.set('fill',color);
  }
  canvas.renderAll();
}

/* Background */
function setBackground(url){
  fabric.Image.fromURL(url, img=>{
    img.scaleToWidth(canvas.width);
    canvas.setBackgroundImage(img,canvas.renderAll.bind(canvas),{
      crossOrigin:'anonymous'
    });
  });
}

function removeBackground(){
  canvas.setBackgroundImage(null,canvas.renderAll.bind(canvas));
}

/* Delete */
function deleteSelected(){
  const obj = canvas.getActiveObject();
  if(obj) canvas.remove(obj);
}

/* Export */
function exportJPG(){
  const link=document.createElement('a');
  link.download='nameplate.jpg';
  link.href=canvas.toDataURL({
    format:'jpeg',
    quality:1,
    multiplier:2
  });
  link.click();
}
</script>

</body>
</html>
