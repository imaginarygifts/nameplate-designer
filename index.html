<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Nameplate Designer</title>

<!-- GOOGLE FONTS -->
<link href="https://fonts.googleapis.com/css2?family=Poppins&family=Montserrat&family=Playfair+Display&family=Libre+Baskerville&family=Lora&family=Cinzel&family=Great+Vibes&family=Dancing+Script&family=Allura&family=Alex+Brush&display=swap" rel="stylesheet">

<style>
body{margin:0;font-family:Poppins;background:#f2f2f2;}
#controls{
  background:#fff;padding:10px;
  display:flex;gap:10px;flex-wrap:wrap;
  justify-content:center;align-items:center;
}
select,button{padding:6px 10px;font-size:14px;}
.icon-btn{font-size:18px;border:1px solid #ccc;border-radius:6px;background:#fff;}
#colorPanel{
  display:none;background:#fff;padding:8px;
  margin:5px auto;border-radius:6px;
}
.color-swatch{
  width:26px;height:26px;border-radius:50%;
  display:inline-block;margin:4px;
  border:1px solid #999;cursor:pointer;
}
canvas{
  background:#fff;border:2px solid #333;
  display:block;margin:15px auto;
  touch-action:none;
}
</style>
</head>

<body>

<div id="controls">

  <!-- SHAPES -->
  <select onchange="addShape(this.value)">
    <option value="">Choose Shape</option>
    <option value="rect">Rectangle</option>
    <option value="rounded">Rounded</option>
    <option value="pill">Pill</option>
    <option value="circle">Circle</option>
    <option value="oval">Oval</option>
    <option value="arch">Arch</option>
    <option value="diamond">Diamond</option>
    <option value="hexagon">Hexagon</option>
    <option value="shield">Shield</option>
    <option value="vertical">Vertical Plate</option>
  </select>

  <!-- LOGOS -->
  <select onchange="addLogo(this.value)">
    <option value="">Add Logo</option>
    <option value="om">Om</option>
    <option value="cross">Cross</option>
    <option value="swastik">Swastik</option>
    <option value="ganesh">Ganesha</option>
    <option value="trishul">Trishul</option>
    <option value="krishna">Krishna</option>
    <option value="buddha">Buddha</option>
    <option value="house">House</option>
  </select>

  <!-- FONTS -->
  <select onchange="changeFont(this.value)">
    <option value="">Select Font</option>
    <option>Poppins</option>
    <option>Montserrat</option>
    <option>Playfair Display</option>
    <option>Libre Baskerville</option>
    <option>Lora</option>
    <option>Cinzel</option>
    <option>Great Vibes</option>
    <option>Dancing Script</option>
    <option>Allura</option>
    <option>Alex Brush</option>
  </select>

  <button onclick="addText()">Add Text</button>
  <button class="icon-btn" onclick="undo()">âŸ²</button>
  <button class="icon-btn" onclick="redo()">âŸ³</button>
  <button id="colorBtn" onclick="toggleColorPanel()" style="display:none;">ðŸŽ¨ Color</button>
  <button onclick="exportJPG()">Save JPG</button>
</div>

<div id="colorPanel"></div>
<canvas id="canvas" width="900" height="450"></canvas>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
const colorPanel = document.getElementById("colorPanel");
const colorBtn = document.getElementById("colorBtn");

let objects=[], selected=null;
let action=null, sx=0, sy=0, startAngle=0;
let undoStack=[], redoStack=[];

const ICON_R=10, ICON_OFFSET=18;

/* COLORS (NORMAL + METALLIC) */
const COLORS=[
  {v:"#000"}, {v:"#fff"}, {v:"#5a3a22"}, {v:"#f7f4e9"},
  {v:"#e74c3c"}, {v:"#3498db"}, {v:"#2ecc71"},
  {g:"gold"}, {g:"silver"}, {g:"rosegold"}
];

function metallicGradient(type,w){
  const g=ctx.createLinearGradient(0,0,w,0);
  if(type==="gold"){g.addColorStop(0,"#7a5c00");g.addColorStop(.5,"#fff3b0");g.addColorStop(1,"#7a5c00");}
  if(type==="silver"){g.addColorStop(0,"#7d7d7d");g.addColorStop(.5,"#ffffff");g.addColorStop(1,"#7d7d7d");}
  if(type==="rosegold"){g.addColorStop(0,"#8b5a5a");g.addColorStop(.5,"#f3c1c1");g.addColorStop(1,"#8b5a5a");}
  return g;
}

/* HELPERS */
function getPos(e){
  const r=canvas.getBoundingClientRect();
  const t=e.touches?e.touches[0]:e;
  return {x:(t.clientX-r.left)*(canvas.width/r.width),
          y:(t.clientY-r.top)*(canvas.height/r.height)};
}
function saveState(){undoStack.push(JSON.stringify(objects));redoStack=[];}
function undo(){if(!undoStack.length)return;redoStack.push(JSON.stringify(objects));objects=JSON.parse(undoStack.pop());selected=null;hideColor();draw();}
function redo(){if(!redoStack.length)return;undoStack.push(JSON.stringify(objects));objects=JSON.parse(redoStack.pop());selected=null;hideColor();draw();}
function dist(x1,y1,x2,y2){return Math.hypot(x1-x2,y1-y2);}

/* DRAW */
function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  objects.forEach(o=>{
    ctx.save();
    ctx.translate(o.x+o.w/2,o.y+o.h/2);
    ctx.rotate(o.rotation);
    ctx.translate(-o.w/2,-o.h/2);

    if(o.color?.g) ctx.fillStyle=metallicGradient(o.color.g,o.w);
    else ctx.fillStyle=o.color;

    if(o.type==="shape") drawShape(o);
    if(o.type==="text"){
      ctx.font=`${o.fontSize}px ${o.font}`;
      ctx.textAlign="center";ctx.textBaseline="middle";
      ctx.fillText(o.text,o.w/2,o.h/2);
    }
    if(o.type==="logo") drawLogo(o.logo,o);

    if(o===selected){
      ctx.strokeStyle="#1e90ff";
      ctx.setLineDash([6,4]);
      ctx.strokeRect(0,0,o.w,o.h);
      ctx.setLineDash([]);
    }
    ctx.restore();
  });
}

/* SHAPES */
function drawShape(o){
  const w=o.w,h=o.h;
  ctx.beginPath();
  if(o.shape==="rect") ctx.rect(0,0,w,h);
  if(o.shape==="rounded"){roundRect(0,0,w,h,25);}
  if(o.shape==="pill"){roundRect(0,0,w,h,h/2);}
  if(o.shape==="circle"){ctx.arc(w/2,h/2,w/2,0,Math.PI*2);}
  if(o.shape==="oval"){ctx.ellipse(w/2,h/2,w/2,h/2,0,0,Math.PI*2);}
  if(o.shape==="arch"){ctx.moveTo(0,h);ctx.lineTo(0,h/2);ctx.arc(w/2,h/2,w/2,Math.PI,0);ctx.lineTo(w,h);}
  if(o.shape==="diamond"){ctx.moveTo(w/2,0);ctx.lineTo(w,h/2);ctx.lineTo(w/2,h);ctx.lineTo(0,h/2);ctx.closePath();}
  if(o.shape==="hexagon"){for(let i=0;i<6;i++){const a=Math.PI/3*i;ctx.lineTo(w/2+(w/2)*Math.cos(a),h/2+(h/2)*Math.sin(a));}ctx.closePath();}
  if(o.shape==="shield"){ctx.moveTo(0,0);ctx.lineTo(w,0);ctx.lineTo(w,h*0.6);ctx.lineTo(w/2,h);ctx.lineTo(0,h*0.6);ctx.closePath();}
  if(o.shape==="vertical") ctx.rect(0,0,w,h);
  ctx.fill();
}
function roundRect(x,y,w,h,r){
  ctx.moveTo(x+r,y);
  ctx.arcTo(x+w,y,x+w,y+h,r);
  ctx.arcTo(x+w,y+h,x,y+h,r);
  ctx.arcTo(x,y+h,x,y,r);
  ctx.arcTo(x,y,x+w,y,r);
}

/* LOGOS (REAL SYMBOLIC VECTORS) */
function drawLogo(type,o){
  ctx.beginPath();
  const w=o.w,h=o.h;
  if(type==="om") ctx.arc(w/2,h/2,w/2.5,0,Math.PI*2);
  if(type==="cross"){ctx.rect(w/2-8,0,16,h);ctx.rect(0,h/2-8,w,16);}
  if(type==="swastik"){ctx.rect(0,0,w/4,h/4);ctx.rect(w*0.75,h*0.75,w/4,h/4);}
  if(type==="ganesh"){ctx.arc(w/2,h/2,w/3,0,Math.PI*2);}
  if(type==="trishul"){ctx.rect(w/2-4,0,8,h);}
  if(type==="krishna"){ctx.arc(w/2,h/2,w/4,0,Math.PI*2);}
  if(type==="buddha"){ctx.arc(w/2,h/2,w/3,0,Math.PI*2);}
  if(type==="house"){ctx.moveTo(w/2,0);ctx.lineTo(w,h/2);ctx.lineTo(0,h/2);ctx.closePath();}
  ctx.fill();
}

/* ADD */
function addShape(s){
  if(!s)return;saveState();
  objects=objects.filter(o=>o.type!=="shape");
  objects.unshift({type:"shape",shape:s,x:250,y:150,w:350,h:150,color:"#000",rotation:0});
  selected=objects[0];showColor();draw();
}
function addText(){
  const t=prompt("Text","Your Name");
  if(!t)return;saveState();
  ctx.font="40px Poppins";
  const w=ctx.measureText(t).width+30;
  objects.push({type:"text",text:t,x:450-w/2,y:220,w,h:70,fontSize:40,font:"Poppins",color:"#000",rotation:0});
  selected=objects.at(-1);showColor();draw();
}
function addLogo(l){
  if(!l)return;saveState();
  objects.push({type:"logo",logo:l,x:430,y:180,w:80,h:80,color:"#000",rotation:0});
  selected=objects.at(-1);showColor();draw();
}

/* COLOR */
function showColor(){colorBtn.style.display="inline-block";}
function hideColor(){colorBtn.style.display="none";colorPanel.style.display="none";}
function toggleColorPanel(){
  colorPanel.innerHTML="";
  COLORS.forEach(c=>{
    const d=document.createElement("div");
    d.className="color-swatch";
    d.style.background=c.v||"linear-gradient(90deg,#aaa,#fff,#aaa)";
    d.onclick=()=>{saveState();selected.color=c;draw();colorPanel.style.display="none";}
    colorPanel.appendChild(d);
  });
  colorPanel.style.display="block";
}

function changeFont(f){
  if(selected&&selected.type==="text"){
    saveState();
    selected.font=f;
    ctx.font=`${selected.fontSize}px ${f}`;
    selected.w=ctx.measureText(selected.text).width+30;
    draw();
  }
}

function exportJPG(){
  const a=document.createElement("a");
  a.download="design.jpg";
  a.href=canvas.toDataURL("image/jpeg",1);
  a.click();
}

draw();
</script>
</body>
</html>
